<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="author" title="About these documents" href="../about.html" /><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Distributed Secure XGBoost" href="distributed.html" /><link rel="prev" title="Secure XGBoost in Jupyter" href="jupyter.html" />

    <meta name="generator" content="sphinx-3.0.3, furo 2021.03.20.beta31"/>
        <title>Outsourced Computation - Secure XGBoost documentation</title>
      <link rel="stylesheet" href="../_static/styles/furo.css?digest=978e1795dfe158b585dda6a8417f6411828bf3ed">
    <link rel="stylesheet" href="../_static/pygments.css">
    <link media="(prefers-color-scheme: dark)" rel="stylesheet" href="../_static/pygments_dark.css">
    


<style>
  :root {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #00B0FF;
  --color-brand-content: #00B0FF;
  --color-admonition-background: #F0F0F0;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #00B0FF;
  --color-brand-content: #00B0FF;
  --color-admonition-background: #F0F0F0;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" href="../_static/styles/furo-extensions.css?digest=d391b54134226e4196576da3bdb6dddb7e05ba2b"></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Secure XGBoost  documentation</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Secure XGBoost  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html">
  <input class="sidebar-search" placeholder=Search name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About Secure XGBoost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started.html">Get Started with Secure XGBoost</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="jupyter.html">Secure XGBoost in Jupyter</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Outsourced Computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="distributed.html">Distributed Secure XGBoost</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiclient-distributed.html">Multiclient Outsourced Distributed Computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="risecamp2020.html">Multiclient Jupyter Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../parameter.html">Secure XGBoost Parameters</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/index.html">Python package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/python_intro.html">Python Package Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/python_api.html">Python API Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshoot.html">Troubleshooting</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <div class="section" id="outsourced-computation">
<h1>Outsourced Computation<a class="headerlink" href="#outsourced-computation" title="Permalink to this headline">¶</a></h1>
<p>Secure XGBoost is tailored toward an outsourced computation model – one in which a client with sensitive data wants to outsource computation on the sensitive data to an untrusted server with a trusted hardware enclave. This tutorial provides an example of such a scenario.</p>
<p>In this example, the enclave server first starts an RPC server to listen for the orchestrator, and the orchestrator starts an RPC server to listen for client requests. The client encrypts data and sends it to the untrusted server. The data remains encrypted until loaded inside the enclave, at which point it can be decrypted. The client sends commands (the APIs to invoke) to the orchestrator, which relays them to server. The server then trains a model on the training data <em>inside the enclave</em> and serves predictions, <em>also inside the enclave</em>. The predictions are then encrypted, pushed out of the enclave, and sent over the network back to the client. The client lastly decrypts the predictions.</p>
<p>The relevant code is located at <code class="docutils literal notranslate"><span class="pre">demo/python/remote-control</span></code>.</p>
<div class="section" id="server-setup">
<h2>Server Setup<a class="headerlink" href="#server-setup" title="Permalink to this headline">¶</a></h2>
<p>First setup a machine that will act as the untrusted server.</p>
<p>We’ll need to start an RPC process on the server to listen for the orchestrator.</p>
<ol class="arabic">
<li><p><strong>Start RPC server</strong></p>
<p>On the server, create the enclave and the RPC server to begin listening.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 demo/python/remote-control/server/enclave_serve.py
</pre></div>
</div>
<p>Once the console outputs “Waiting for client…”, proceed to orchestrator setup.</p>
</li>
</ol>
</div>
<div class="section" id="orchestrator-setup">
<h2>Orchestrator Setup<a class="headerlink" href="#orchestrator-setup" title="Permalink to this headline">¶</a></h2>
<p>Next setup a machine that will act as the RPC orchestrator.</p>
<p>Modify the <code class="docutils literal notranslate"><span class="pre">nodes</span></code> argument in the <code class="docutils literal notranslate"><span class="pre">xgb.serve()</span></code> function in the <code class="docutils literal notranslate"><span class="pre">demo/python/remote-control/start_orchestrator.py</span></code> script to reflect the IP address of the server. The <code class="docutils literal notranslate"><span class="pre">port</span></code> argument tells the RPC orchestrator which port to listen for client commands on.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xgb.serve<span class="o">(</span><span class="nv">all_users</span><span class="o">=[</span><span class="s2">"user1"</span><span class="o">]</span>, <span class="nv">nodes</span><span class="o">=[</span><span class="s2">"&lt;SERVER_IP&gt;"</span><span class="o">]</span>, <span class="nv">port</span><span class="o">=</span><span class="m">50052</span><span class="o">)</span>
</pre></div>
</div>
<p>Run the script to start the orchestrator.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 demo/python/remote-control/start_orchestrator.py
</pre></div>
</div>
</div>
<div class="section" id="client-setup">
<h2>Client Setup<a class="headerlink" href="#client-setup" title="Permalink to this headline">¶</a></h2>
<p>We’ll be setting up the client so that it’s ready to remotely initiate a job on its own data. <strong>Before doing this setup, ensure that you’ve already setup the server and the orchestrator.</strong></p>
<p>This setup will involve encrypting data on the client, transferring the data to the server, then initiating the XGBoost code.</p>
<p><code class="docutils literal notranslate"><span class="pre">cd</span></code> into the <code class="docutils literal notranslate"><span class="pre">demo/python/remote-control/client</span></code> directory to begin setup.</p>
<ol class="arabic">
<li><p><strong>Encrypt data locally.</strong></p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">encrypt.py</span></code> script to generate a key and encrypt the sample data (<code class="docutils literal notranslate"><span class="pre">demo/data/agaricus.txt.train</span></code> and <code class="docutils literal notranslate"><span class="pre">demo/data/agaricus.txt.test</span></code>). It will output three files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">demo/python/remote-control/client/key.txt</span></code> : the key used to encrypt the data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">demo/python/remote-control/data/train.enc</span></code> : an encrypted version of the training data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">demo/python/remote-control/data/test.enc</span></code>  : an encrypted version of the test data</p></li>
</ul>
<p>Run the following to encrypt.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 encrypt.py
</pre></div>
</div>
</li>
<li><p><strong>Send encrypted data to the server</strong></p>
<p>We assume that there will be a mechanism to transfer the encrypted data to the server. For the purposes of this demo, the user can try, for example, <code class="docutils literal notranslate"><span class="pre">scp</span></code> to perform this transfer.</p>
<p>If simulating a client/server setup locally, think of the <code class="docutils literal notranslate"><span class="pre">demo/python/remote-control/data/</span></code> directory as external storage mounted to both the client and server machines.</p>
</li>
<li><p><strong>Make client calls</strong></p>
<p>On the client, send commands to the server by running <code class="docutils literal notranslate"><span class="pre">client.py</span></code>. The <code class="docutils literal notranslate"><span class="pre">client.py</span></code> script takes in 4 arguments: the IP address of the server, the path to the generated key, the path to the user’s private key, and the path to the user’s certificate. We’ve included a sample private key and certificate for this example.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3 client.py --ip-addr &lt;orchestrator-ip&gt; --symmkey key.txt --privkey ../../../data/userkeys/private_user_1.pem --cert ../../../data/usercrts/user1.crt --port <span class="m">50052</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">client.py</span></code> takes in 5 arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--ip-addr</span></code> : IP address of the orchestrator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--symmkey</span></code> : path to the client’s symmetric key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--privkey</span></code> : path to the client’s private key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--cert</span></code> : path to the client’s certificate</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--port</span></code> : port on which the orchestrator is listening</p></li>
</ul>
<p>For convenience, we added a script <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> in this directory that runs this command. It takes in one argument: the orchestrator IP.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./run.sh &lt;orchestrator-ip&gt;
</pre></div>
</div>
</li>
</ol>
</div>
</div>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="distributed.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Distributed Secure XGBoost</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="jupyter.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Secure XGBoost in Jupyter</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2020, Secure XGBoost developers
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            |
            <a class="muted-link" href="../_sources/tutorials/outsourced.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Outsourced Computation</a><ul>
<li><a class="reference internal" href="#server-setup">Server Setup</a></li>
<li><a class="reference internal" href="#orchestrator-setup">Orchestrator Setup</a></li>
<li><a class="reference internal" href="#client-setup">Client Setup</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </main>
</div>
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/scripts/main.js?digest=e931d09b2a40c1bb82b542effe772014573baf67"></script></body>
</html>